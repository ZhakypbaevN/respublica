import{d as E,u as A,r as _,i as F,o as b,c as N,b as s,t as d,l as G,m as R,_ as z,p as V,q as O,a as f,f as C,w as p,e as l,F as X,s as Z,g as U,E as J,v as x,x as ee,y as q,z as te,A as ae,n as W,B as I,C as le,T as se,D as oe,G as ne,H as ie,I as de,k as ue}from"./index-392a09ae.js";const re={class:"name"},ce={class:"status"},me=E({__name:"SelectUserItem",props:{data:{}},emits:["select"],setup(B,{emit:S}){const{t:o}=A(),c=B,k=_(null);F(()=>{k.value=Object.assign({},c.data)});const m=n=>n=="admin"?o("status.admin"):n=="manager"?o("status.manager"):n=="editor"?o("status.media"):o("status.client");return(n,u)=>(b(),N("tr",{class:"usersItem",onClick:u[0]||(u[0]=()=>n.$emit("select"))},[s("td",null,d(n.data.iin??"-"),1),s("td",re,d(`${n.data.last_name} ${n.data.first_name} ${n.data.middle_name??""}`),1),s("td",ce,[s("span",null,d(m(n.data.role)),1)]),s("td",null,d(n.data.phone?G(R)(n.data.phone):"-"),1),s("td",null,d(n.data.email??"-"),1)]))}});const pe=z(me,[["__scopeId","data-v-00ab9584"]]),fe={class:"users"},ve={class:"users-header"},he={key:0,class:"users-table"},be={class:"users-head"},ke=E({__name:"SelectUserModal",props:{show:{type:Boolean}},emits:["hide","update:select"],setup(B,{emit:S}){const o=S,c=_({offset:0,limit:20,search:""}),k=_(!1),m=_(),n=V({tableValues:null,total:0,isEmpty:!1,searchEmpty:!0}),u=()=>{m.value=null,k.value=!0},D=t=>{o("update:select",t),o("hide")},$=async()=>{n.tableValues=null,n.isEmpty=!1;const{data:t,total:i}=await x(c.value);n.tableValues=t,n.total=i,i||(n.tableValues=[],n.isEmpty=!0)};return F(()=>$()),O(()=>c.value,ee($),{deep:!0}),(t,i)=>{const L=f("Input"),P=f("SvgIcon"),T=f("Button"),a=f("Pagination"),e=f("Modal");return b(),N("div",null,[t.show?(b(),C(e,{key:0,big:"",onHide:i[3]||(i[3]=r=>t.$emit("hide")),class:"selectUserModal",title:t.$t("page.users"),maxInner:1400},{default:p(()=>[s("div",fe,[s("div",ve,[l(L,{modelValue:c.value.search,"onUpdate:modelValue":i[0]||(i[0]=r=>c.value.search=r),staticPlaceholder:"",placeholder:t.$t("formdata.search-by-fio")},null,8,["modelValue","placeholder"]),l(T,{class:"users-header-addNewsBtn",type:"default-blue",onClick:u},{default:p(()=>[l(P,{name:"plus",viewboxWidth:24,viewboxHeight:24})]),_:1})]),n.tableValues?(b(),N("table",he,[s("thead",null,[s("tr",be,[s("th",null,d(t.$t("formdata.iin")),1),s("th",null,d(t.$t("formdata.fio")),1),s("th",null,d(t.$t("formdata.role")),1),s("th",null,d(t.$t("formdata.phone")),1),s("th",null,d(t.$t("formdata.email")),1)])]),s("tbody",null,[(b(!0),N(X,null,Z(n.tableValues,r=>(b(),C(pe,{key:r.id,data:r,class:"users-table-item",onSelect:()=>D(r)},null,8,["data","onSelect"]))),128))])])):U("",!0),l(a,{offset:c.value.offset,"onUpdate:offset":i[1]||(i[1]=r=>c.value.offset=r),limit:c.value.limit,"onUpdate:limit":i[2]||(i[2]=r=>c.value.limit=r),total:n.total},null,8,["offset","limit","total"])])]),_:1},8,["title"])):U("",!0),k.value?(b(),C(J,{key:1,data:m.value,onHide:i[4]||(i[4]=()=>k.value=!1)},null,8,["data"])):U("",!0)])}}});const ye=z(ke,[["__scopeId","data-v-d201c644"]]),ge={class:"feedbackModal-selectPeopleBlock"},_e={class:"feedbackModal-selectPeopleBlock-btn-avatar"},$e=["innerHTML"],Me={class:"feedbackModal-inputs"},we={class:"feedbackModal-inputs-joinDate"},Ne={class:"feedbackModal-inputs-gender"},De={key:0},Ie={class:"feedbackModal-inputs-home"},Ue={class:"feedbackModal-inputs-subtitle"},Se={class:"feedbackModal-checkboxList-block"},Ve={class:"feedbackModal-checkboxList"},Ce={class:"feedbackModal-checkboxList"},Be=E({__name:"CreatePartyModal",emits:["hide","finish"],setup(B,{emit:S}){const{t:o}=A(),{toast:c}=ue(),k=S,m=V({selectUser:!1,createUser:!1,selectTicketNum:!1}),n=_(!1),u=_(),D=_([]),$=_([]),t=V({regionID:null,locationID:null,ticketNum:null,gender:"female",joinDate:q().format("YYYY-MM-DD")}),i=V({location:!1,ticketNum:!1}),L=[{label:o("social-status.self-employed-persons-with-disabilities"),value:o("social-status.self-employed-persons-with-disabilities")},{label:o("social-status.student"),value:o("social-status.student")},{label:o("social-status.persons-on-parental-leave"),value:o("social-status.persons-on-parental-leave")},{label:o("social-status.pensioners"),value:o("social-status.pensioners")},{label:o("social-status.unemployed"),value:o("social-status.unemployed")},{label:o("social-status.working"),value:o("social-status.working")},{label:o("social-status.large-families"),value:o("social-status.large-families")}];F(async()=>{(await te()).data.data.forEach(e=>{D.value.push({label:e.name,value:e.id.toString(),childrens:e.childrens})})}),O(()=>t.regionID,()=>{$.value=[],t.locationID=null,i.location=!1,D.value.forEach(a=>{Number(a.value)===Number(t.regionID)&&(a.childrens.length||(i.location=!0),a.childrens.forEach(e=>{$.value.push({label:e.name,value:e.id.toString()})}))})});const P=({education:a,specialization:e,workPlace:r,post:g,streat:M,home:h,apartment:w,dateBirthday:H,pensioner:Y,disabled:j,unemployed:v,onChildcareLeave:y,socialStatus:K})=>{const Q={birth_date:q(H).format("YYYY-MM-DD"),gender:t.gender,education:a,specialty:e.length?e:null,workplace:r.length?r:null,position:g.length?g:null,social_status:K,location_id:Number(t.locationID??t.regionID),street:M,house:h,apartment:w===""?null:w,is_pensioner:Y,is_disabled:j,is_unemployed:v,is_on_childcare_leave:y,user_id:u.value.id,status:"active",join_date:q(t.joinDate).format("YYYY-MM-DD"),ticket_number:i.ticketNum&&t.ticketNum?t.ticketNum.ticket_number:null};T(Q)},T=async a=>{n.value=!0;try{await ie(a)&&(c({message:o("message.you-have-successfully-joined-the-party"),type:"success"}),i.ticketNum&&(await de(t.ticketNum.id),c({message:o("message.vip-number-has-been-successfully-deleted"),type:"success"})),k("finish"),setTimeout(()=>{k("hide")},300))}catch(e){e.response.data.detail==="Duplicate membership is not allowed."?c({message:o("errors.you-have-already-joined-the-parties"),type:"warning"}):e.response.data.detail==="Age under 18 is not allowed."&&c({message:o("errors.accommodation-under-the-age-of-18-is-not-allowed"),type:"warning"})}finally{n.value=!1}};return(a,e)=>{const r=f("SvgIcon"),g=f("Button"),M=f("Checkbox"),h=f("Input"),w=f("Select"),H=f("Form"),Y=f("Modal"),j=ae("collapse");return b(),N("div",null,[l(Y,{onHide:e[11]||(e[11]=v=>k("hide")),class:"feedbackModal",title:G(o)("party.creating-a-party-member")},{default:p(()=>[s("div",ge,[l(g,{class:W(["feedbackModal-selectPeopleBlock-btn",{active:u.value}]),type:"outline-grey",onClick:e[0]||(e[0]=()=>m.selectUser=!0)},{left:p(()=>[s("div",_e,[l(r,{name:"avatar",viewboxWidth:44,viewboxHeight:44})]),s("span",{class:"feedbackModal-selectPeopleBlock-btn-text",innerHTML:u.value?`${u.value.last_name} ${u.value.first_name} ${u.value.middle_name??""}`:`${a.$t("button.select-a-user")} <span>*</span>`},null,8,$e)]),_:1},8,["class"]),l(g,{type:"default-light-blue",class:"feedbackModal-selectPeopleBlock-tip",onClick:e[1]||(e[1]=()=>m.selectUser=!0)},{default:p(()=>[l(r,{name:u.value?"loop":"touch",viewboxWidth:24,viewboxHeight:24},null,8,["name"])]),_:1}),s("button",{class:"feedbackModal-selectPeopleBlock-createBtn",onClick:e[2]||(e[2]=()=>m.createUser=!0)},d(a.$t("button.create-a-user")),1)]),l(H,{onFinish:P,ignores:i.location?["locality"]:null},{default:p(()=>{var v;return[l(M,{class:"feedbackModal-inputs-ticketNum-checkBox",modelValue:i.ticketNum,"onUpdate:modelValue":e[3]||(e[3]=y=>i.ticketNum=y)},{default:p(()=>[I(d(a.$t("button.select-a-vip-room")),1)]),_:1},8,["modelValue"]),l(le,{class:W(["feedbackModal-inputs-ticketNum",{disabled:!i.ticketNum}]),num:(v=t.ticketNum)==null?void 0:v.ticket_number,ticketNum:t.ticketNum,defaultNum:null,onShowModalSelect:e[4]||(e[4]=()=>m.selectTicketNum=!0),onToDefault:e[5]||(e[5]=()=>t.ticketNum=null)},null,8,["class","num","ticketNum"]),s("div",Me,[s("div",we,[l(h,{type:"date",name:"joinDate",placeholder:a.$t("formdata.date-of-issue-of-the-ticket"),modelValue:t.joinDate,"onUpdate:modelValue":e[6]||(e[6]=y=>t.joinDate=y),required:""},null,8,["placeholder","modelValue"])]),s("div",Ne,[l(h,{type:"date",name:"dateBirthday",placeholder:a.$t("formdata.date-of-birth"),required:""},null,8,["placeholder"]),l(g,{name:a.$t("status.female"),type:t.gender==="female"?"default-blue":"outline-grey",onClick:e[7]||(e[7]=()=>t.gender="female")},null,8,["name","type"]),l(g,{name:a.$t("status.male"),type:t.gender==="male"?"default-blue":"outline-grey",onClick:e[8]||(e[8]=()=>t.gender="male")},null,8,["name","type"])]),l(w,{name:"socialStatus",placeholder:a.$t("formdata.social-status"),options:L,required:""},null,8,["placeholder"]),l(w,{name:"education",placeholder:a.$t("formdata.specify-your-education"),options:[{label:a.$t("status.higher"),value:"higher_education"},{label:a.$t("status.average"),value:"secondary_special_education"}],required:""},null,8,["placeholder","options"]),l(h,{name:"specialization",placeholder:a.$t("formdata.specialization")},null,8,["placeholder"]),l(h,{name:"workPlace",placeholder:a.$t("formdata.place-of-work")},null,8,["placeholder"]),l(h,{name:"post",placeholder:a.$t("formdata.post")},null,8,["placeholder"]),l(w,{name:"region",placeholder:a.$t("formdata.specify-the-area"),options:D.value,modelValue:t.regionID,"onUpdate:modelValue":e[9]||(e[9]=y=>t.regionID=y),required:""},null,8,["placeholder","options","modelValue"]),l(se,null,{default:p(()=>[i.location?U("",!0):oe((b(),N("div",De,[l(w,{name:"locality",placeholder:a.$t("formdata.locality"),options:$.value.length?$.value:[{label:a.$t("status.first-select-an-area"),value:null}],modelValue:t.locationID,"onUpdate:modelValue":e[10]||(e[10]=y=>t.locationID=y),required:""},null,8,["placeholder","options","modelValue"])])),[[j]])]),_:1}),s("div",Ie,[l(h,{name:"streat",placeholder:a.$t("formdata.street-prospect-mkr"),required:""},null,8,["placeholder"]),l(h,{name:"home",placeholder:a.$t("formdata.house"),required:""},null,8,["placeholder"]),l(h,{name:"apartment",placeholder:a.$t("formdata.sq")},null,8,["placeholder"])]),s("div",null,[s("h4",Ue,d(a.$t("formdata.do-you-belong-to-the-category")),1),s("div",Se,[s("div",Ve,[l(M,{name:"pensioner",class:"feedbackModal-checkboxList-item"},{default:p(()=>[I(d(a.$t("social-category.user-status-pensioner")),1)]),_:1}),l(M,{name:"disabled",class:"feedbackModal-checkboxList-item"},{default:p(()=>[I(d(a.$t("social-category.user-status-disabled")),1)]),_:1})]),s("div",Ce,[l(M,{name:"unemployed",class:"feedbackModal-checkboxList-item"},{default:p(()=>[I(d(a.$t("social-category.user-status-unemployed")),1)]),_:1}),l(M,{name:"onChildcareLeave",class:"feedbackModal-checkboxList-item"},{default:p(()=>[I(d(a.$t("social-category.user-status-on-childcare-leave")),1)]),_:1})])])])]),l(g,{name:a.$t("button.create"),loading:n.value,htmlType:"submit",ignoreValidate:i.location?["locality"]:null},null,8,["name","loading","ignoreValidate"])]}),_:1},8,["ignores"])]),_:1},8,["title"]),l(ye,{show:m.selectUser,select:u.value,"onUpdate:select":e[12]||(e[12]=v=>u.value=v),onHide:e[13]||(e[13]=()=>m.selectUser=!1)},null,8,["show","select"]),m.createUser?(b(),C(J,{key:0,onHide:e[14]||(e[14]=()=>m.createUser=!1),data:u.value,"onUpdate:data":e[15]||(e[15]=v=>u.value=v)},null,8,["data"])):U("",!0),l(ne,{show:m.selectTicketNum,onSelect:e[16]||(e[16]=v=>t.ticketNum=v),onHide:e[17]||(e[17]=()=>m.selectTicketNum=!1)},null,8,["show"])])}}});const Pe=z(Be,[["__scopeId","data-v-4d012d28"]]);export{Pe as C};
