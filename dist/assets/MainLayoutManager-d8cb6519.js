import{d as H,i as o,f as U,j as L,k as ee,r as u,l as ae,o as M,g as A,w as d,b as a,a as l,m as y,n as te,T as J,q as le,c as B,s as P,u as oe,t as se,p as Y,e as F,_ as C,A as ne,h as ie}from"./index-676341cb.js";import{S as de}from"./SideBar-b18d93da.js";const ce=n=>(Y("data-v-6f0769be"),n=n(),F(),n),ue={class:"feedbackModal-inputs"},re={class:"feedbackModal-inputs-gender"},me={key:0},pe={class:"feedbackModal-inputs-home"},_e=ce(()=>l("h4",{class:"feedbackModal-inputs-subtitle"}," Относится пользователь к категории: ",-1)),ve={class:"feedbackModal-checkboxList-block"},he={class:"feedbackModal-checkboxList"},be={class:"feedbackModal-checkboxList"},fe=H({__name:"createPartyModal",props:{show:{type:Boolean}},emits:["hide","finish"],setup(n,{emit:_}){const{toast:c}=oe(),v=n,h=_,m=o(!1),b=o("female"),j=localStorage.getItem("TOKEN"),S=o([]),V=o([]),f=o(null),x=o(null),g=o(!1),T=o([]),D=o(),$=o(!0),q=o(null),E=o([]),z=[{label:"Самозанятые, лица с ограниченными возможностями",value:"Самозанятые, лица с ограниченными возможностями"},{label:"Студент",value:"Студент"},{label:"Лица находящиеся в отпуске по уходу за детьми",value:"Лица находящиеся в отпуске по уходу за детьми"},{label:"Пенсионеры",value:"Пенсионеры"},{label:"Безработные",value:"Безработные"},{label:"Работающие",value:"Работающие"},{label:"Многодетные",value:"Многодетные"}];U(()=>{L({method:"get",url:"https://api.respublica.codetau.com/api/v1/parties/locations?offset=0&limit=100"}).then(e=>{e.data.forEach(t=>{S.value.push({label:t.name,value:t.id.toString(),childrens:t.childrens})})}).catch(e=>{console.log("err",e),c({message:"Возникли ошибки при запросе"})}),O(),R()});const O=()=>{L({method:"get",url:"https://api.respublica.codetau.com/api/v1/admin/users?offset=0&limit=100"}).then(e=>{e.data.forEach(t=>{T.value.push({label:`${t.first_name} ${t.last_name} ${t.middle_name??""}`,value:JSON.stringify(t)})})}).catch(e=>{console.log("err",e),c({message:"Возникли ошибки при запросе"})})},R=()=>{L({method:"get",url:"https://api.respublica.codetau.com/api/v1/admin/parties/memberships/reserved-ticket-numbers?offset=0&limit=100"}).then(e=>{e.data.forEach(t=>{E.value.push({label:t.ticket_number,value:t.id.toString()})})}).catch(e=>{console.log("err",e),c({message:"Возникли ошибки при запросе"})})};ee(()=>f.value,()=>{V.value=[],x.value=null,g.value=!1,S.value.forEach(i=>{Number(i.value)===Number(f.value)&&(i.childrens.length||(g.value=!0),i.childrens.forEach(e=>{V.value.push({label:e.name,value:e.id.toString()})}))})});const G=({education:i,specialization:e,workPlace:t,post:p,streat:r,home:k,apartment:w,dateBirthday:I,pensioner:N,disabled:s,unemployed:W,onChildcareLeave:Q,socialStatus:X})=>{const Z={birth_date:se(I).format("YYYY-MM-DD"),gender:b.value,education:i,specialty:e.length?e:null,workplace:t.length?t:null,position:p.length?p:null,social_status:X,location_id:Number(x.value??f.value),street:r,house:k,apartment:w===""?null:w,is_pensioner:N,is_disabled:s,is_unemployed:W,is_on_childcare_leave:Q};K(Z)},K=i=>{m.value=!0,L({method:"post",url:"https://api.respublica.codetau.com/api/v1/parties/memberships",data:i,headers:{accept:"application/json",Authorization:"Bearer "+j}}).then(t=>{console.log("response",t),c({message:"Вы успешно вступили в партию",type:"success"}),h("finish"),setTimeout(()=>{h("hide")},300),m.value=!1}).catch(t=>{t.response.data.detail==="Duplicate membership is not allowed."?c({message:"Возникли ошибки при запросе"}):t.response.data.detail==="Age under 18 is not allowed."?c({message:"Проживание в возрасте до 18 лет не допускается"}):c({message:"Возникли ошибки при запросе"}),console.log("err",t),m.value=!1})};return(i,e)=>{const t=u("Select"),p=u("Checkbox"),r=u("Input"),k=u("Button"),w=u("Form"),I=u("Modal"),N=ae("collapse");return v.show?(M(),A(I,{key:0,onHide:e[7]||(e[7]=s=>h("hide")),class:"feedbackModal",title:"Создание партийного билета"},{default:d(()=>[a(w,{onFinish:G,ignores:g.value?["locality"]:null},{default:d(()=>[l("div",ue,[a(t,{name:"user-data",placeholder:"Выберите пользователя",options:T.value,modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=s=>D.value=s),required:""},null,8,["options","modelValue"]),a(p,{name:"confirm-3",class:"feedbackModal-inputs-customTicketNum",modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=s=>$.value=s)},{default:d(()=>[y(" Автоматическая генерация номера ")]),_:1},8,["modelValue"]),l("div",{class:te(["feedbackModal-inputs-ticketNumSelect",{disabled:$.value}])},[a(t,{name:"ticket-num",placeholder:"Укажите номер билета",options:E.value,modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=s=>q.value=s),required:""},null,8,["options","modelValue"])],2),l("div",re,[a(r,{type:"date",name:"dateBirthday",placeholder:"Дата рождения",required:""}),a(k,{name:"Женщина",type:b.value==="female"?"default-blue":"outline-grey",onClick:e[3]||(e[3]=()=>b.value="female")},null,8,["type"]),a(k,{name:"Мужчина",type:b.value==="male"?"default-blue":"outline-grey",onClick:e[4]||(e[4]=()=>b.value="male")},null,8,["type"])]),a(t,{name:"socialStatus",placeholder:"Социальный статус",options:z,required:""}),a(t,{name:"education",placeholder:"Укажите образование",options:[{label:"Высшее",value:"higher_education"},{label:"Среднее",value:"secondary_special_education"}],required:""}),a(r,{name:"specialization",placeholder:"Специальность"}),a(r,{name:"workPlace",placeholder:"Место работы"}),a(r,{name:"post",placeholder:"Должность"}),a(t,{name:"region",placeholder:"Укажите область",options:S.value,modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=s=>f.value=s),required:""},null,8,["options","modelValue"]),a(J,null,{default:d(()=>[g.value?P("",!0):le((M(),B("div",me,[a(t,{name:"locality",placeholder:"Населенный пункт",options:V.value.length?V.value:[{label:"Сначало выберите область",value:null}],modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s),required:""},null,8,["options","modelValue"])])),[[N]])]),_:1}),l("div",pe,[a(r,{name:"streat",placeholder:"Улица/Проспект/Мкр"}),a(r,{name:"home",placeholder:"Дом"}),a(r,{name:"apartment",placeholder:"Кв."})]),l("div",null,[_e,l("div",ve,[l("div",he,[a(p,{name:"pensioner",class:"feedbackModal-checkboxList-item"},{default:d(()=>[y(" Пенсионеры ")]),_:1}),a(p,{name:"disabled",class:"feedbackModal-checkboxList-item"},{default:d(()=>[y(" Инвалиды ")]),_:1})]),l("div",be,[a(p,{name:"unemployed",class:"feedbackModal-checkboxList-item"},{default:d(()=>[y(" Безработные ")]),_:1}),a(p,{name:"onChildcareLeave",class:"feedbackModal-checkboxList-item"},{default:d(()=>[y(" Находящиеся в отпуске по уходу за детьми ")]),_:1})])])])]),a(k,{name:"Отправить заявку",loading:m.value,htmlType:"submit",ignoreValidate:g.value?["locality"]:null},null,8,["loading","ignoreValidate"])]),_:1},8,["ignores"])]),_:1})):P("",!0)}}});const ge=C(fe,[["__scopeId","data-v-6f0769be"]]),ke=n=>(Y("data-v-400db317"),n=n(),F(),n),ye={class:"header"},Me={class:"header-main",id:"header-main"},Ve={class:"wrapper"},xe={class:"header-main-inner"},we={class:"header-main-right"},Le=ke(()=>l("button",{class:"header-main-lang"},[l("span",null,"РУ")],-1)),Se=H({__name:"HeaderManager",setup(n){const _=o(!1);return(c,v)=>{const h=u("SvgIcon"),m=u("RouterLink"),b=u("Button");return M(),B("header",ye,[l("div",Me,[l("div",Ve,[l("div",xe,[a(m,{to:"/",class:"header-main-logo"},{default:d(()=>[a(h,{class:"logo-big",name:"logo",viewboxWidth:260,viewboxHeight:49})]),_:1}),l("div",we,[l("button",{onClick:v[0]||(v[0]=()=>_.value=!0),class:"header-main-logo"},[a(b,{name:"Создать члена партии",type:"default-blue"})]),Le,a(ne)])])])]),a(ge,{show:_.value,onHide:v[1]||(v[1]=()=>_.value=!1)},null,8,["show"])])}}});const $e=C(Se,[["__scopeId","data-v-400db317"]]);const Ie={class:"layout"},Ne={class:"layout-inner"},Be={class:"layout-content",id:"layout-content"},Ce={__name:"MainLayoutManager",setup(n){U(()=>{document.body.style="height:100vh;overflow:hidden;"});const _=[{title:"Члены партии",link:"/manager/party-list/active"},{title:"Заявки на удаление",link:"/manager/party-resignation-list"},{title:"Удаленные",link:"/manager/party-list/revoked"},{title:"VIP номера",link:"/manager/ticket-num-data-list"},{title:"Аналитика",link:"/manager/analytics"}];return(c,v)=>{const h=u("router-view");return M(),B("div",Ie,[a($e),l("div",Ne,[a(de,{list:_}),l("div",Be,[a(h,null,{default:d(({Component:m})=>[a(J,{mode:"out-in"},{default:d(()=>[(M(),A(ie(m),{key:c.$route.path}))]),_:2},1024)]),_:1})])])])}}},qe=C(Ce,[["__scopeId","data-v-2fab2889"]]);export{qe as default};
