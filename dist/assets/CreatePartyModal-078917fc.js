import{d as T,u as z,r as m,i as j,o as b,c as S,b as s,t as d,l as W,m as R,_ as Y,p as A,q as O,a as p,f as L,w as v,e as t,F as X,s as Z,g as V,E as G,v as x,x as ee,y as ae,z as te,n as le,T as se,A as oe,B,C as ne,D as ie,k as de}from"./index-ff97958b.js";const ue={class:"name"},re={class:"status"},ce=T({__name:"SelectUserItem",props:{data:{}},emits:["select"],setup(P,{emit:I}){const{t:o}=z(),u=P,_=m(null);j(()=>{_.value=Object.assign({},u.data)});const c=l=>l=="admin"?o("status.admin"):l=="manager"?o("status.manager"):l=="editor"?o("status.media"):o("status.client");return(l,f)=>(b(),S("tr",{class:"usersItem",onClick:f[0]||(f[0]=()=>l.$emit("select"))},[s("td",null,d(l.data.iin??"-"),1),s("td",ue,d(`${l.data.last_name} ${l.data.first_name} ${l.data.middle_name??""}`),1),s("td",re,[s("span",null,d(c(l.data.role)),1)]),s("td",null,d(l.data.phone?W(R)(l.data.phone):"-"),1),s("td",null,d(l.data.email??"-"),1)]))}});const me=Y(ce,[["__scopeId","data-v-00ab9584"]]),pe={class:"users"},ve={class:"users-header"},fe={key:0,class:"users-table"},he={class:"users-head"},be=T({__name:"SelectUserModal",props:{show:{type:Boolean}},emits:["hide","update:select"],setup(P,{emit:I}){const o=I,u=m({offset:0,limit:20,search:""}),_=m(!1),c=m(),l=A({tableValues:null,total:0,isEmpty:!1,searchEmpty:!0}),f=()=>{c.value=null,_.value=!0},r=i=>{o("update:select",i),o("hide")},M=async()=>{l.tableValues=null,l.isEmpty=!1;const{data:i,total:n}=await x(u.value);l.tableValues=i,l.total=n,n||(l.tableValues=[],l.isEmpty=!0)};return j(()=>M()),O(()=>u.value,ee(M),{deep:!0}),(i,n)=>{const w=p("Input"),k=p("SvgIcon"),D=p("Button"),E=p("Pagination"),N=p("Modal");return b(),S("div",null,[i.show?(b(),L(N,{key:0,big:"",onHide:n[3]||(n[3]=e=>i.$emit("hide")),class:"selectUserModal",title:i.$t("page.users"),maxInner:1400},{default:v(()=>[s("div",pe,[s("div",ve,[t(w,{modelValue:u.value.search,"onUpdate:modelValue":n[0]||(n[0]=e=>u.value.search=e),staticPlaceholder:"",placeholder:i.$t("formdata.search-by-fio")},null,8,["modelValue","placeholder"]),t(D,{class:"users-header-addNewsBtn",type:"default-blue",onClick:f},{default:v(()=>[t(k,{name:"plus",viewboxWidth:24,viewboxHeight:24})]),_:1})]),l.tableValues?(b(),S("table",fe,[s("thead",null,[s("tr",he,[s("th",null,d(i.$t("formdata.iin")),1),s("th",null,d(i.$t("formdata.fio")),1),s("th",null,d(i.$t("formdata.role")),1),s("th",null,d(i.$t("formdata.phone")),1),s("th",null,d(i.$t("formdata.email")),1)])]),s("tbody",null,[(b(!0),S(X,null,Z(l.tableValues,e=>(b(),L(me,{key:e.id,data:e,class:"users-table-item",onSelect:()=>r(e)},null,8,["data","onSelect"]))),128))])])):V("",!0),t(E,{offset:u.value.offset,"onUpdate:offset":n[1]||(n[1]=e=>u.value.offset=e),limit:u.value.limit,"onUpdate:limit":n[2]||(n[2]=e=>u.value.limit=e),total:l.total},null,8,["offset","limit","total"])])]),_:1},8,["title"])):V("",!0),_.value?(b(),L(G,{key:1,data:c.value,onHide:n[4]||(n[4]=()=>_.value=!1)},null,8,["data"])):V("",!0)])}}});const _e=Y(be,[["__scopeId","data-v-d201c644"]]),ye={class:"feedbackModal-selectPeopleBlock"},ge={class:"feedbackModal-selectPeopleBlock-btn-avatar"},ke={class:"feedbackModal-inputs"},$e={class:"feedbackModal-inputs-gender"},Me={key:0},we={class:"feedbackModal-inputs-home"},Ue={class:"feedbackModal-inputs-subtitle"},Se={class:"feedbackModal-checkboxList-block"},Ce={class:"feedbackModal-checkboxList"},Ve={class:"feedbackModal-checkboxList"},Ie=T({__name:"CreatePartyModal",emits:["hide","finish"],setup(P,{emit:I}){const{t:o}=z(),{toast:u}=de(),_=I,c=A({selectUser:!1,createUser:!1}),l=m(!1),f=m("female"),r=m(),M=m([]),i=m([]),n=m(null),w=m(null),k=m(!1),D=[{label:o("social-status.self-employed-persons-with-disabilities"),value:o("social-status.self-employed-persons-with-disabilities")},{label:o("social-status.student"),value:o("social-status.student")},{label:o("social-status.persons-on-parental-leave"),value:o("social-status.persons-on-parental-leave")},{label:o("social-status.pensioners"),value:o("social-status.pensioners")},{label:o("social-status.unemployed"),value:o("social-status.unemployed")},{label:o("social-status.working"),value:o("social-status.working")},{label:o("social-status.large-families"),value:o("social-status.large-families")}];j(async()=>{(await ae()).data.data.forEach(a=>{M.value.push({label:a.name,value:a.id.toString(),childrens:a.childrens})})}),O(()=>n.value,()=>{i.value=[],w.value=null,k.value=!1,M.value.forEach(e=>{Number(e.value)===Number(n.value)&&(e.childrens.length||(k.value=!0),e.childrens.forEach(a=>{i.value.push({label:a.name,value:a.id.toString()})}))})});const E=({education:e,specialization:a,workPlace:C,post:g,streat:y,home:U,apartment:$,dateBirthday:q,pensioner:H,disabled:F,unemployed:h,onChildcareLeave:J,socialStatus:K})=>{const Q={birth_date:ne(q).format("YYYY-MM-DD"),gender:f.value,education:e,specialty:a.length?a:null,workplace:C.length?C:null,position:g.length?g:null,social_status:K,location_id:Number(w.value??n.value),street:y,house:U,apartment:$===""?null:$,is_pensioner:H,is_disabled:F,is_unemployed:h,is_on_childcare_leave:J,user_id:r.value.id,status:"active",join_date:null,ticket_number:null};N(Q)},N=async e=>{l.value=!0;try{await ie(e)&&(u({message:o("message.you-have-successfully-joined-the-party"),type:"success"}),_("finish"),setTimeout(()=>{_("hide")},300))}catch(a){a.response.data.detail==="Duplicate membership is not allowed."?u({message:o("errors.you-have-already-joined-the-parties"),type:"warning"}):a.response.data.detail==="Age under 18 is not allowed."&&u({message:o("errors.accommodation-under-the-age-of-18-is-not-allowed"),type:"warning"})}finally{l.value=!1}};return(e,a)=>{const C=p("SvgIcon"),g=p("Button"),y=p("Input"),U=p("Select"),$=p("Checkbox"),q=p("Form"),H=p("Modal"),F=te("collapse");return b(),S("div",null,[t(H,{onHide:a[7]||(a[7]=h=>_("hide")),class:"feedbackModal",title:W(o)("party.creating-a-party-member")},{default:v(()=>[s("div",ye,[t(g,{class:le(["feedbackModal-selectPeopleBlock-btn",{active:r.value}]),name:r.value?`${r.value.last_name} ${r.value.first_name} ${r.value.middle_name??""}`:e.$t("button.select-a-user"),type:"outline-grey",onClick:a[0]||(a[0]=()=>c.selectUser=!0),Ñ‹:""},{left:v(()=>[s("div",ge,[t(C,{name:"avatar",viewboxWidth:44,viewboxHeight:44})])]),_:1},8,["class","name"]),t(g,{type:"default-light-blue",class:"feedbackModal-selectPeopleBlock-tip",onClick:a[1]||(a[1]=()=>c.selectUser=!0)},{default:v(()=>[t(C,{name:r.value?"loop":"touch",viewboxWidth:24,viewboxHeight:24},null,8,["name"])]),_:1}),s("button",{class:"feedbackModal-selectPeopleBlock-createBtn",onClick:a[2]||(a[2]=()=>c.createUser=!0)},d(e.$t("button.create-a-user")),1)]),t(q,{onFinish:E,ignores:k.value?["locality"]:null},{default:v(()=>[s("div",ke,[s("div",$e,[t(y,{type:"date",name:"dateBirthday",placeholder:e.$t("formdata.date-of-birth"),required:""},null,8,["placeholder"]),t(g,{name:e.$t("status.female"),type:f.value==="female"?"default-blue":"outline-grey",onClick:a[3]||(a[3]=()=>f.value="female")},null,8,["name","type"]),t(g,{name:e.$t("status.male"),type:f.value==="male"?"default-blue":"outline-grey",onClick:a[4]||(a[4]=()=>f.value="male")},null,8,["name","type"])]),t(U,{name:"socialStatus",placeholder:e.$t("formdata.social-status"),options:D,required:""},null,8,["placeholder"]),t(U,{name:"education",placeholder:e.$t("formdata.specify-your-education"),options:[{label:e.$t("status.higher"),value:"higher_education"},{label:e.$t("status.average"),value:"secondary_special_education"}],required:""},null,8,["placeholder","options"]),t(y,{name:"specialization",placeholder:e.$t("formdata.specialization")},null,8,["placeholder"]),t(y,{name:"workPlace",placeholder:e.$t("formdata.place-of-work")},null,8,["placeholder"]),t(y,{name:"post",placeholder:e.$t("formdata.post")},null,8,["placeholder"]),t(U,{name:"region",placeholder:e.$t("formdata.specify-the-area"),options:M.value,modelValue:n.value,"onUpdate:modelValue":a[5]||(a[5]=h=>n.value=h),required:""},null,8,["placeholder","options","modelValue"]),t(se,null,{default:v(()=>[k.value?V("",!0):oe((b(),S("div",Me,[t(U,{name:"locality",placeholder:e.$t("formdata.locality"),options:i.value.length?i.value:[{label:e.$t("status.first-select-an-area"),value:null}],modelValue:w.value,"onUpdate:modelValue":a[6]||(a[6]=h=>w.value=h),required:""},null,8,["placeholder","options","modelValue"])])),[[F]])]),_:1}),s("div",we,[t(y,{name:"streat",placeholder:e.$t("formdata.street-prospect-mkr"),required:""},null,8,["placeholder"]),t(y,{name:"home",placeholder:e.$t("formdata.house"),required:""},null,8,["placeholder"]),t(y,{name:"apartment",placeholder:e.$t("formdata.sq")},null,8,["placeholder"])]),s("div",null,[s("h4",Ue,d(e.$t("formdata.do-you-belong-to-the-category")),1),s("div",Se,[s("div",Ce,[t($,{name:"pensioner",class:"feedbackModal-checkboxList-item"},{default:v(()=>[B(d(e.$t("social-category.user-status-pensioner")),1)]),_:1}),t($,{name:"disabled",class:"feedbackModal-checkboxList-item"},{default:v(()=>[B(d(e.$t("social-category.user-status-disabled")),1)]),_:1})]),s("div",Ve,[t($,{name:"unemployed",class:"feedbackModal-checkboxList-item"},{default:v(()=>[B(d(e.$t("social-category.user-status-unemployed")),1)]),_:1}),t($,{name:"onChildcareLeave",class:"feedbackModal-checkboxList-item"},{default:v(()=>[B(d(e.$t("social-category.user-status-on-childcare-leave")),1)]),_:1})])])])]),t(g,{name:e.$t("button.create"),loading:l.value,htmlType:"submit",ignoreValidate:k.value?["locality"]:null},null,8,["name","loading","ignoreValidate"])]),_:1},8,["ignores"])]),_:1},8,["title"]),t(_e,{show:c.selectUser,select:r.value,"onUpdate:select":a[8]||(a[8]=h=>r.value=h),onHide:a[9]||(a[9]=()=>c.selectUser=!1)},null,8,["show","select"]),c.createUser?(b(),L(G,{key:0,onHide:a[10]||(a[10]=()=>c.createUser=!1),data:r.value,"onUpdate:data":a[11]||(a[11]=h=>r.value=h)},null,8,["data"])):V("",!0)])}}});const Le=Y(Ie,[["__scopeId","data-v-623bbd45"]]);export{Le as C};
